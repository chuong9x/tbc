<p><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="bc.css">
<!--
<script src="run_prettify.js" type="text/javascript"></script>
<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js" type="text/javascript"></script>
-->
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js" type="text/javascript"></script>
</head></p>
<!---

- publish /a/doc/forge/ recording for aec jim q

- devcon promo
  DevCon promo toolbox has slides for presentations or flyers for meet-ups - Please use:
  https://forge.autodesk.com/devcon-promo-tools
  https://autodesk.app.box.com/folder/34726869489
  You're our awesome dev community influencers - please retweet, share and like AutodeskForge Tweets about DevCon (and more;-) (edited)
  Other resources you might find helpful for Dev evangelism:
  For info about Forge and what the APIs offer -
  https://autodesk.box.com/s/khqe1tohno1fzhveegoziynkmpmh4lhu
  Community Success stories & use cases to see what people are doing with Forge -
  https://autodesk.box.com/s/wt2nica2rwfst47hkt80szdvyrjk3ptd
  Forge OTS page for all other Forge info and resources -
  https://autodesksales.gosavo.com/CustomPage/View.aspx?id=39136343&srlid=51521699&srisprm=False&sritidx=1&srpgidx=0&srpgsz=2

- How to pull the starting view for document using the Revit API
  https://stackoverflow.com/questions/45696372/how-to-pull-the-starting-view-for-document-using-the-revit-api

- Moving Detail Group only moves its LocationPoint, not detail items inside
  Moving items inside Detail Group
  https://forums.autodesk.com/t5/revit-api-forum/moving-detail-group-only-moves-its-locationpoint-not-detail/m-p/7302496

- 13269724 [Family Instance Filter]
  https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2018.0.134.2
  https://forums.autodesk.com/t5/revit-api-forum/family-instance-filter/m-p/7287113

 #RevitAPI @AutodeskRevit #bim #dynamobim @AutodeskForge #ForgeDevCon 

&ndash; ...

--->

<h3>Forge for AEC, DevCon, Revit versus Forge, Ids and Add-In Installation</h3>
<h4><a name="2"></a>Forge for AEC Demos and Sample Code</h4>
<p>Last week, I briefly discussed some pros and cons
of <a href="http://thebuildingcoder.typepad.com/blog/2017/08/revit-versus-forge-ids-and-add-in-installation.html#2">Revit versus Forge for BIM programming</a>.</p>
<p>Since then, im Quanci, Senior Director Software Partner Development at Autodesk,
published <a href="https://youtu.be/5xVwvBzemkg">Autodesk Forge - what is it?</a>, a 45 minute video recording showing what's possible to do
with <a href="https://forge.autodesk.com">Forge</a> through a set of demos and live code samples:</p>
<p><center>
<iframe width="480" height="270" src="https://www.youtube.com/embed/5xVwvBzemkg?rel=0" frameborder="0" allowfullscreen></iframe>
</center></p>
<p>If this spiked your interest, you will certainly benefit from the <a href="https://forge.autodesk.com/devcon-2017">Forge developer conference DevCon</a> taking place just before Autodesk University in Las vegas November 13-14.</p>
<h4><a name="3"></a>Determining the Starting View</h4>
<p><a href="https://stackoverflow.com/users/180529/skeletank">Skeletank</a> shared
an interesting and illuminating solution on StackOverflow 
showing <a href="https://stackoverflow.com/questions/45696372/how-to-pull-the-starting-view-for-document-using-the-revit-api">how to pull the starting view for document using the Revit API</a>:</p>
<p><strong>Question:</strong> How can I use the Revit API to get the Starting View for a Document? The equivalent way to access it using the user interface is seen below:</p>
<p><center>
<img src="img/starting_view_ui.png" alt="Starting view" width="651"/>
</center></p>
<p><strong>Answer:</strong> I used
the <a href="https://github.com/jeremytammik/RevitLookup">RevitLookup tool</a> and
browsed through the database to find a class called <code>StartingViewSettings</code> with the property <code>ViewId</code> that returns the <code>ElementId</code> of the starting view:</p>
<p><center>
<img src="img/starting_view_snoop.png" alt="Starting view" width="804"/>
</center></p>
<p>Here is my actual code for getting the view:</p>
<pre pre class="code">
  FilteredElementCollector a
    = new FilteredElementCollector( doc )
      .OfClass( typeof( StartingViewSettings ) );

  View startingView = null;

  foreach( StartingViewSettings settings in a )
  {
    startingView = doc.GetElement(
      settings.ViewId ) as View;
  }
</pre>

<p>Many thanks to skeletank for researching and sharing this, and describing the effective approach to do so!</p>
<h4><a name="4"></a>Detect Installed Revit Version</h4>
<p>Another issue was raised by my consulting colleague Miro Schonauer:</p>
<p><strong>Question:</strong> What is the best way to check if any version and, if so, what version of Revit is installed?</p>
<p>I checked Windows registry keys mentioned in the discussion on 
the <a href="http://thebuildingcoder.typepad.com/blog/2013/04/perpetual-guid-algorithm-and-revit-2014-product-guids.html">perpetual GUID algorithm and Revit 2014 product GUIDs</a>, 
but that is only up to Revit 2014 and still not sure we can detect 'any version'.</p>
<p><strong>Answer:</strong> One choice it to use <code>RevitProductUtility</code> API provided by the <code>RevitAddInUtility.dll</code> assembly:</p>
<pre pre class="code">
            IList < RevitProduct > allInstalledRevitProducts  = RevitProductUtility.GetAllInstalledRevitProducts();
            foreach (RevitProduct revitProduct in allInstalledRevitProducts)
            {
                if (revitProduct.Version == RevitVersion.Revit2015)
                {
                    // Revit 2015 installed.
                } 
                else if (revitProduct.Version == RevitVersion.Revit2017)
                {
                    // Revit 2017 installed.
                }
         }
</pre>

<h4><a name="5"></a>Detect Installed C3D Version</h4>
<p>Another query from Miro, not on Revit, but such a closely related topic, so let's mention it as well:</p>
<p><strong>Question:</strong> I would like to issue a warning if there is no C3D installed on the machine.</p>
<p>What is the best way to verify this?</p>
<p>Can I simply check if a certain registry entry exists?</p>
<p>I thought of using:</p>
<ul>
<li>C3D 2015<ul>
<li>HKEY_LOCAL_MACHINE\SOFTWARE\Autodesk\AutoCAD\R20.0\ACAD-E000:409 &ndash; English</li>
<li>HKEY_LOCAL_MACHINE\SOFTWARE\Autodesk\AutoCAD\R20.0\InstalledProducts\C3D &ndash; any locale</li>
</ul>
</li>
<li>C3D 2015<ul>
<li>HKEY_LOCAL_MACHINE\SOFTWARE\Autodesk\AutoCAD\R21.0\ACAD-0000:409</li>
<li>HKEY_LOCAL_MACHINE\SOFTWARE\Autodesk\AutoCAD\R21.0\InstalledProducts\C3D</li>
</ul>
</li>
</ul>
<p><strong>Answer:</strong> Itâ€™s better to use these:</p>
<ul>
<li>HKEY_LOCAL_MACHINE\SOFTWARE\Autodesk\AutoCAD\R20.0\InstalledProducts\C3D</li>
<li>HKEY_LOCAL_MACHINE\SOFTWARE\Autodesk\AutoCAD\R21.0\InstalledProducts\C3D</li>
</ul>
<p>Many thanks to Miro for raising and clarifying this!</p>
<h4><a name="6"></a>Moving Items Inside a Detail Group</h4>
<p>Fair59 solved another issue in
the <a href="http://forums.autodesk.com/t5/revit-api-forum/bd-p/160">Revit API discussion forum</a> thread 
on <a href="https://forums.autodesk.com/t5/revit-api-forum/moving-detail-group-only-moves-its-locationpoint-not-detail/m-p/7302496">moving detail group only moves its locationpoint, not detail items inside</a>:</p>
<p><strong>Question:</strong> </p>
<p><strong>Answer:</strong></p>
<h4><a name="7"></a>Filter for Family Instances and Types by Family Name</h4>
<p>Yet another issue in 
the <a href="http://forums.autodesk.com/t5/revit-api-forum/bd-p/160">Revit API discussion forum</a> thread
on implermenting
a <a href="https://forums.autodesk.com/t5/revit-api-forum/family-instance-filter/m-p/7287113">family instance filter</a> led
to a little update and
new <a href="https://github.com/jeremytammik/the_building_coder_samples/releases/tag/2018.0.134.2">release 2018.0.134.2</a>
of <a href="https://github.com/jeremytammik/the_building_coder_samples">The Building Coder samples</a>:</p>
<p><strong>Question:</strong> </p>
<p><strong>Answer:</strong></p>
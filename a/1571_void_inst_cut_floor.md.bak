<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="bc.css">
<!--
<script src="run_prettify.js" type="text/javascript"></script>
<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js" type="text/javascript"></script>
-->
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js" type="text/javascript"></script>
</head>

<!---

Determine RVT version using #Python #RevitAPI @AutodeskRevit #bim #dynamobim @AutodeskForge #ForgeDevCon 

&ndash; 
...

-->

### Determining Void Instances Cutting a Floor

Yet another brilliant solution provided by Fair59, answering
the [Revit API discussion forum](http://forums.autodesk.com/t5/revit-api-forum/bd-p/160) thread 
on how
to [get cutting void instances in the floor](https://forums.autodesk.com/t5/revit-api-forum/get-cutting-void-instances-in-the-floor/m-p/7170237):

**Question:**

minet.axel


1 Post
Post 1 of 5
Report
Accepted SolutionGet cutting void instances in the floor 
Options
44 Views, 4 Replies
2017-06-21 10:25 PM
Hello,
I have a floor on which a familyinstance is inserted on the face of the floor (the instance to host: the floor). I checked in the family the "Cut with Void When Loaded" parameter so that the void created on the floor. I want to retrieve the instance that creates the void in the floor.
I did some research, and found this link: http: //thebuildingcoder.typepad.com/blog/2011/06/boolean-operations-and-instancevoidcututils.html But when I use InstanceVoidCutUtils.GetCuttingVoidInstances(element) returns an empty list.
Solved! by FAIR59. See the answer in context.
Kudo
try using
 
 List<ElementId> intersectingInstanceIds = floor.FindInserts(false,false,false,true).ToList();
 Add Tag...
QUICK REPLY
REPLY
Kudo
ESCALATE TO SALESFORCE
jeremytammik
The Building Coder



3052 Posts
1163 Kudos
438 Solutions

Post 2 of 5
Report
Re: Get cutting void instances in the floor 
Options
2017-06-22 09:41 AM in reply to: minet.axel
This discussion should provide hints to all you need:
 
http://thebuildingcoder.typepad.com/blog/2015/07/intersect-solid-filter-avf-and-directshape-for-debu...
 
I hope it helps.
 
Please let us know how it goes and how you end up resolving this.
 
Thank you!
 
Cheers,
 
Jeremy
 

Jeremy Tammik
Developer Technical Services
Autodesk Developer Network, ADN Open
The Building Coder

 Add Tag...
QUICK REPLY
REPLY
 Kudo
ACCEPT AS SOLUTION
minet.axel


1 Post
Post 3 of 5
Report
Re: Get cutting void instances in the floor   
Options
2017-06-22 10:17 AM in reply to: jeremytammik
 
lsdlfs
 
I want to deduce the voids in the floor. But when I use ElementIntersectsElementFilter or ElementIntersectsSolidFilter, I do not have the expected result (no elements intersect).
 
First case : area = 607.558m2 and Volume = 243.023m3
 
1.PNG
Second case : area = 607.558m2 and Volume = 243.023m3
 
 
 
2.PNG
 Family parameter
 
 3.PNG
 FamilyInstance cutting
4.PNG
 
 
 
Solid solid = floor.get_Geometry(new Options())
.OfType<Solid>()
.Where<Solid>(s => null != s && !s.Edges.IsEmpty)
.FirstOrDefault();

FilteredElementCollector intersectingInstances = new FilteredElementCollector(doc)
.OfClass(typeof(FamilyInstance))
.WherePasses(new ElementIntersectsSolidFilter(solid));

int n1 = intersectingInstances.Count<Element>();

intersectingInstances = new FilteredElementCollector(doc)
.OfClass(typeof(FamilyInstance))
.WherePasses(new ElementIntersectsElementFilter(floor));

int n = intersectingInstances.Count<Element>();
 
Here "n" and "n1" are equal to 0.
 
 
 Add Tag...
QUICK REPLY
REPLY
Kudo
ACCEPT AS SOLUTION
FAIR59


199 Posts
110 Kudos
55 Solutions
1 Idea
Post 4 of 5
Report
Solution!Re: Get cutting void instances in the floor   
Options
2017-06-22 10:43 AM in reply to: minet.axel
try using
 
                List<ElementId> intersectingInstanceIds = floor.FindInserts(false,false,false,true).ToList();
 Add Tag...
QUICK REPLY
REPLY
1 Kudo
Kudo|
minet.axel


1 Post
Post 5 of 5
Report
Re: Get cutting void instances in the floor   
Options
2017-06-22 11:20 AM in reply to: FAIR59
I have done some tests and here are my returns.
6 ppt.PNG
 
 
FindInserts returns FI_1 even if its host (Level 3) is not the floor. Its good.I think we can say that the problem is solved.
 
Thank you FAIR59 ;).


<center>
<img src="img/openrevitolestorage.png" alt="Revit OLE storage" width="567">
</center>

<pre class="code">
</pre>

Thank you very much for sharing this, Frederic!

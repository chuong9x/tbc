<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="bc.css">
<script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js" type="text/javascript"></script>

<style>
  ul.toc { list-style-type: none; }
  h1.new { font-size: 150%; }
  h2.new { font-size: 150%; }
  h3.new { font-size: 120%; }
  h4.new { font-size: 120%; }
</style>

</head>

<!---
  
twitter:

What's New in the Revit 2021 API #RevitAPI @AutodeskForge @AutodeskRevit #bim #DynamoBim #ForgeDevCon http://bit.ly/rvt2021apinews

The Revit 2021 API includes exciting enhancements for add-in developers, including numerous developer wishes and requests that have now been explicitly addressed
&ndash; Information sources
&ndash; What's new in previous versions
&ndash; Detailed TOC of major changes and renovations
&ndash; API Changes
&ndash; API Additions...

linkedin:

-->

### What's New in the Revit 2021 API

The Revit 2021 API includes exciting enhancements for add-in developers, including numerous developer wishes and requests that have now been explicitly addressed:

- [Information sources](#1) 
- [What's new in previous versions](#2) 
- [Detailed TOC of major changes and renovations](#4)

####<a name="1"></a>Information Sources

The information below is based on the contents of the *Revit Platform API Changes and Additions.docx* document included with
the Revit 2021 SDK, the software developers kit available from 
the [Revit Developer Centre](https://www.autodesk.com/developer-network/platform-technologies/revit).

It is also provided in the section on *What's New* in the Revit 2021 API help file `RevitAPI.chm` included with the SDK:

<center>
<img src="img/whats_new_2021.png" alt="Revit 2021 API help on What's New" title="Revit 2021 API help on What's New" width="688"/>
</center>

For convenient, easy and effective web searching, this blog post provides an online version of that information, both in pure HTML (below) and as a PDF document:

- [Revit_Platform_API_Changes_and_Additions_2021.pdf](zip/Revit_Platform_API_Changes_and_Additions_2021.pdf)

The *What's New* section and the *Changes and Additions* document provide important information, both for discovering and exploring the newly added API functionality and for later reference.

If you encounter any issues migrating your existing add-ins between different versions, this is one of the first places to look.

For detailed information on all other aspects of the Revit API, please refer to the rest of the API documentation and samples provided in the SDK.

The most important things to install and always keep at hand are:

- The Revit API help file `RevitAPI.chm`
- The Visual Studio solution containing all the SDK samples, `Samples\SDKSamples.sln`

You will need both of these regularly for research on how to solve specific Revit API programming tasks.

More in-depth official explanations and background information is provided by the
online [Revit API Developers Guide](http://help.autodesk.com/view/RVT/2021/ENU/?guid=Revit_API_Revit_API_Developers_Guide_html) included 
in the [Revit 2021 online help](http://help.autodesk.com/view/RVT/2021/ENU).


####<a name="2"></a>What's New in Previous Versions

Here are links to previous discussions of *What's New in the Revit API*:

- [What's New in the Revit 2010 API](http://thebuildingcoder.typepad.com/blog/2013/02/whats-new-in-the-revit-2010-api.html)
- [What's New in the Revit 2011 API](http://thebuildingcoder.typepad.com/blog/2013/02/whats-new-in-the-revit-2011-api.html)
- [What's New in the Revit 2012 API](http://thebuildingcoder.typepad.com/blog/2013/02/whats-new-in-the-revit-2012-api.html)
- [What's New in the Revit 2013 API](http://thebuildingcoder.typepad.com/blog/2013/03/whats-new-in-the-revit-2013-api.html)
- [What's New in the Revit 2014 API](http://thebuildingcoder.typepad.com/blog/2013/04/whats-new-in-the-revit-2014-api.html)
- [What's New in the Revit 2015 API](http://thebuildingcoder.typepad.com/blog/2014/04/whats-new-in-the-revit-2015-api.html)
- [What's New in the Revit 2016 API](http://thebuildingcoder.typepad.com/blog/2015/04/whats-new-in-the-revit-2016-api.html)
- [What's New in the Revit 2017 API](http://thebuildingcoder.typepad.com/blog/2016/04/whats-new-in-the-revit-2017-api.html)
- [What's New in the Revit 2017.1 API](http://thebuildingcoder.typepad.com/blog/2016/11/whats-new-in-the-revit-20171-api.html)
- [What's New in the Revit 2018 API](http://thebuildingcoder.typepad.com/blog/2017/04/whats-new-in-the-revit-2018-api.html)
- [Revit 2018.1 and the Visual Materials API](http://thebuildingcoder.typepad.com/blog/2017/08/revit-20181-and-the-visual-materials-api.html)
- [Revit 2018.1.1 and 2018.1 API Docs Online](http://thebuildingcoder.typepad.com/blog/2017/09/revit-201811-fixes-cropbox-setting.html)
- [Revit 2018.1 Visual Materials API](http://thebuildingcoder.typepad.com/blog/2017/11/modifying-material-visual-appearance.html)
- [What's New in the Revit 2018.2 API](http://thebuildingcoder.typepad.com/blog/2017/12/whats-new-in-the-revit-20182-api.html)
- [What's New in the Revit 2019 API](http://thebuildingcoder.typepad.com/blog/2018/04/whats-new-in-the-revit-2019-api.html)
- [What's New in the Revit 2020 API](https://thebuildingcoder.typepad.com/blog/2019/04/whats-new-in-the-revit-2020-api.html)
- [What's New in the Revit 2020.1 API](https://thebuildingcoder.typepad.com/blog/2019/09/whats-new-in-the-revit-20201-api.html)

####<a name="4"></a>Detailed TOC of Major Changes and Renovations

<ul class="toc">
<li>1 <a href="#4.1">API changes</a></li>
<ul class="toc">
<li>1.1 <a href="#4.1.1">.NET 4.8</a></li>
<li>1.2 <a href="#4.1.2">Requirement for Transport Layer Security (TLS) Setting in Revit Add-ons</a></li>
<li>1.3 <a href="#4.1.3">Units API changes</a></li>
<ul class="toc">
<li>1.3.1 <a href="#4.1.3.1">List of deprecated and replaced APIs related to units</a></li>
</ul>
<li>1.4 <a href="#4.1.4">Structural Connections API changes</a></li>
<li>1.5 <a href="#4.1.5">Electrical API changes</a></li>
<li>1.6 <a href="#4.1.6">Cloud Model API changes</a></li>
<li>1.7 <a href="#4.1.7">Raytrace view mode removed</a></li>
<li>1.8 <a href="#4.1.8">Schedule API change</a></li>
<li>1.9 <a href="#4.1.9">Slanted Walls</a></li>
<li>1.10 <a href="#4.1.10">Path of Travel API change</a></li>
<li>1.11 <a href="#4.1.11">Geometry API changes</a></li>
<li>1.12 <a href="#4.1.12">Extensible Storage API change</a></li>
<li>1.13 <a href="#4.1.13">BuiltInParameter names corrected</a></li>
<li>1.14 <a href="#4.1.14">SpaceType names corrected</a></li>
<li>1.15 <a href="#4.1.15">Image API changes</a></li>
<li>1.16 <a href="#4.1.16">Obsolete API removal</a></li>
<ul class="toc">
<li>1.16.1.1 <a href="#4.1.16.1.1">Classes</a></li>
<li>1.16.1.2 <a href="#4.1.16.1.2">Methods</a></li>
</ul>
</ul>

<li>2 <a href="#4.2">API additions</a></li>
<ul class="toc">
<li>2.1 <a href="#4.2.1">Systems Analysis API additions</a></li>
<ul class="toc">
<li>2.1.1 <a href="#4.2.1.1">Mechanical Analytical Systems</a></li>
<li>2.1.2 <a href="#4.2.1.2">Zone equipment</a></li>
<li>2.1.3 <a href="#4.2.1.3">System-Zones</a></li>
<li>2.1.4 <a href="#4.2.1.4">Systems Analysis and Analysis Reports</a></li>
<li>2.1.5 <a href="#4.2.1.5">Export to gbXML</a></li>
<li>2.1.6 <a href="#4.2.1.6">Application settings</a></li>
</ul>
<li>2.2 <a href="#4.2.2">Electrical API additions</a></li>
<ul class="toc">
<li>2.2.1 <a href="#4.2.2.1">Circuit naming</a></li>
<li>2.2.2 <a href="#4.2.2.2">Access to circuit naming, switchboards and other properties</a></li>
</ul>
<li>2.3 <a href="#4.2.3">Element and ElementFilter additions</a></li>
<ul class="toc">
<li>2.3.1 <a href="#4.2.3.1">Element History</a></li>
<li>2.3.2 <a href="#4.2.3.2">Element Filters</a></li>
</ul>
<li>2.4 <a href="#4.2.4">Document API additions</a></li>
<li>2.5 <a href="#4.2.5">View API additions</a></li>
<ul class="toc">
<li>2.5.1 <a href="#4.2.5.1">Split sections</a></li>
<li>2.5.2 <a href="#4.2.5.2">Temporary View Modes</a></li>
<li>2.5.3 <a href="#4.2.5.3">Filters</a></li>
</ul>
<li>2.6 <a href="#4.2.6">Schedule API additions</a></li>
<ul class="toc">
<li>2.6.1 <a href="#4.2.6.1">Striped rows</a></li>
<li>2.6.2 <a href="#4.2.6.2">Frozen header</a></li>
</ul>
<li>2.7 <a href="#4.2.7">Path of Travel API</a></li>
<ul class="toc">
<li>2.7.1 <a href="#4.2.7.1">Reveal Obstacles mode for Path of Travel</a></li>
<li>2.7.2 <a href="#4.2.7.2">Path finding analysis for Path of Travel</a></li>
<li>2.7.3 <a href="#4.2.7.3">Waypoints</a></li>
</ul>
<li>2.8 <a href="#4.2.8">Export API additions</a></li>
<ul class="toc">
<li>2.8.1 <a href="#4.2.8.1">CustomExporter events</a></li>
</ul>
<li>2.9 <a href="#4.2.9">Options API additions</a></li>
<ul class="toc">
<li>2.9.1 <a href="#4.2.9.1">Color options</a></li>
</ul>
<li>2.10 <a href="#4.2.10">Geometry API additions</a></li>
<ul class="toc">
<li>2.10.1 <a href="#4.2.10.1">Surfaces</a></li>
<li>2.10.2 <a href="#4.2.10.2">Edges</a></li>
<li>2.10.3 <a href="#4.2.10.3">Meshes</a></li>
<li>2.10.4 <a href="#4.2.10.4">Geometry utilities</a></li>
</ul>
<li>2.11 <a href="#4.2.11">Image API additions</a></li>
<ul class="toc">
<li>2.11.1 <a href="#4.2.11.1">Image properties</a></li>
<li>2.11.2 <a href="#4.2.11.2">Converting images between links and imports</a></li>
</ul>
<li>2.12 <a href="#4.2.12">Cloud Model API additions</a></li>
<ul class="toc">
<li>2.12.1 <a href="#4.2.12.1">Regions</a></li>
<li>2.12.2 <a href="#4.2.12.2">Opening Cloud Models</a></li>
</ul>
<li>2.13 <a href="#4.2.13">Structural Connection API addition</a></li>
<ul class="toc">
<li>2.13.1 <a href="#4.2.13.1">Connections requiring additional points</a></li>
</ul>
<li>2.14 <a href="#4.2.14">Reinforcement API additions</a></li>
<ul class="toc">
<li>2.14.1 <a href="#4.2.14.1">Rebar constraints</a></li>
<li>2.14.2 <a href="#4.2.14.2">Rebar end treatment</a></li>
<li>2.14.3 <a href="#4.2.14.3">Fabric Sheet visibility</a></li>
<li>2.14.4 <a href="#4.2.14.4">Out of plane hook rotation angles</a></li>
<li>2.14.5 <a href="#4.2.14.5">Hook length overrides</a></li>
</ul>
<li>2.15 <a href="#4.2.15">Material API addition</a></li>
<li>2.16 <a href="#4.2.16">Analysis Visualization Framework API addition</a></li>
<li>2.17 <a href="#4.2.17">Shared Coordinates API additions</a></li>
<ul class="toc">
<li>2.17.1 <a href="#4.2.17.1">Internal Origin</a></li>
<li>2.17.2 <a href="#4.2.17.2">BasePoint</a></li>
</ul>
</ul>
</ul>

<p></p>

<center>
<div style="border-style:solid; border-width:2px 0px 2px 0px">
<a name="4.1"></a><h1 class="new" style="font-weight: bold">API Changes</h1>
</div>
</center>

<a name="4.1.1"></a><h2 class="new">1.1. .NET 4.8</h2>

Revit's API assemblies are built using .NET 4.8.

At a minimum, add-ons will need to target .NET 4.8 for Revit 2021.

<a name="4.1.2"></a><h2 class="new">1.2. Requirement for Transport Layer Security (TLS) Setting in Revit Add-ons</h2>

When your add-on requires Internet communications and a specific security protocol is involved, if the protocol is TLS 1.0, 1.1 or 1.2, you don’t need to write any setting in the add-on, you may just take advantage of the native TLS support in Revit and its target .NET Framework. The complexities due to variety of Windows versions as well as .NET Framework versions have been well handled in Revit.

If the addon still needs to specify a security protocol or its version, do not hard-code it exclusively, e.g. by directly assigning the protocol/version to the application-wide property ServicePointManager.SecurityProtocol. This will override Revit’s native TLS configuration, which is critical for Revit to communicate with various Autodesk cloud services. A problematic setting is like

<pre>
  System.Net.ServicePointManager.SecurityProtocol
    = System.Net.SecurityProtocolType.Tls12;
</pre>

Instead you need to specify the protocol/version inclusively, e.g. by using bitwise OR (logical OR) on the application-wide property ServicePointManager.SecurityProtocol. A correct setting is like

<pre>
  System.Net.ServicePointManager.SecurityProtocol
    |= System.Net.SecurityProtocolType.Tls12;
</pre>

<a name="4.1.3"></a><h2 class="new">1.3. Units API changes</h2>

Revit has converted to use an external reference to unit definitions defined in Forge schemas.

In the Autodesk.Revit.DB namespace, the enumerations DisplayUnitType, UnitSymbolType, and UnitType have been deprecated in favor of a potentially extensible set of units, symbols, and unit types. The new class:

- Autodesk.Revit.DB.ForgeTypeId

represents an identifier for a unit, symbol, or other object, and is now used throughout the Revit API to identify units of measurement, symbols, and unit types. Unit types are now referred to as "specs" to avoid confusion with units themselves.

A ForgeTypeId instance holds a string, called a "typeid", that uniquely identifies a Forge schema. A Forge schema is a JSON document describing a data structure, supporting data interchange between applications. A typeid string includes a namespace and version number and may look something like "autodesk.spec.aec:length-1.0.0" or "autodesk.unit.unit:meters-1.0.0". By default, comparison of ForgeTypeId values in the Revit API ignores the version number.

The new classes:

- Autodesk.Revit.DB.UnitTypeId
- Autodesk.Revit.DB.SymbolTypeId
- Autodesk.Revit.DB.SpecTypeId 

contain a default set of named public constant properties of type ForgeTypeId. These values can be used in code replacing values of the deprecated DisplayUnitType, UnitSymbolType, and UnitType enumerations.

For example, where you previously used DisplayUnitType.DUT_WATTS_PER_SQUARE_METER_KELVIN, you would now use UnitTypeId.WattsPerSquareMeterKelvin. Where you previously used UnitType.UT_HVAC_Density, you would now use SpecTypeId.HvacDensity.

The UnitUtils class now offers a set of new methods for mapping between enumeration values and ForgeTypeId values to assist clients in migrating code to ForgeTypeId:

- UnitUtils.IsSymbol()
- UnitUtils.GetSpecTypeId()
- UnitUtils.GetUnitType()
- UnitUtils.GetUnitTypeId()
- UnitUtils.GetDisplayUnitType()
- UnitUtils.GetSymbolTypeId()
- UnitUtils.GetUnitSymbolType()

Some of the preceding methods are new but are already deprecated. They have been added to the API only to assist clients in migrating code from the old enumerations to the ForgeTypeId class.

<a name="4.1.3.1"></a><h3 class="new">1.3.1. List of deprecated and replaced APIs related to units</h2>

Deprecated enumerations in Autodesk.Revit.DB:

- Deprecated &rarr; Replacement
- DisplayUnitType &rarr; UnitTypeId
- UnitSymbolType &rarr; SymbolTypeId
- UnitType &rarr; SpecTypeId

Autodesk.Revit.DB.UnitUtils:

- Deprecated &rarr; Replacement
- static double Convert(double, DisplayUnitType, DisplayUnitType) &rarr; static double Convert(double, ForgeTypeId currentUnitTypeId, ForgeTypeId desiredUnitTypeId)
- static double ConvertFromInternalUnits(double, DisplayUnitType) &rarr; static double ConvertFromInternalUnits(double, ForgeTypeId unitTypeId)
- static double ConvertToInternalUnits(double, DisplayUnitType) &rarr; static double ConvertToInternalUnits(double, ForgeTypeId unitTypeId)
- static bool IsValidDisplayUnit(DisplayUnitType) &rarr; static bool IsUnit(ForgeTypeId unitTypeId)
- static List<DisplayUnitType> GetValidDisplayUnits() &rarr; static List<ForgeTypeId> GetAllUnits()
- static bool IsValidDisplayUnit(UnitType, DisplayUnitType) &rarr; static bool IsValidUnit(ForgeTypeId specTypeId, ForgeTypeId unitTypeId)
- static List<DisplayUnitType> GetValidDisplayUnits(UnitType) &rarr; static List<ForgeTypeId> GetValidUnits(ForgeTypeId specTypeId)
- static string GetTypeCatalogString(DisplayUnitType) &rarr; static string GetTypeCatalogStringForUnit(ForgeTypeId unitTypeId)
- static bool IsValidUnitType(UnitType) &rarr; static bool IsSpec(ForgeTypeId specTypeId)
- static List<UnitType> GetValidUnitTypes() &rarr; static List<ForgeTypeId> GetAllSpecs()
- static UnitGroup GetUnitGroup(UnitType) &rarr; static UnitGroup GetUnitGroup(ForgeTypeId specTypeId)
- static string GetTypeCatalogString(UnitType) &rarr; static string GetTypeCatalogStringForSpec(ForgeTypeId specTypeId)

Autodesk.Revit.DB.ExtensibleStorage.Entity:

- Deprecated &rarr; Replacement
- FieldType Get(Field, DisplayUnitType) &rarr; FieldType Get(Field, ForgeTypeId unitTypeId)
- FieldType Get(string, DisplayUnitType) &rarr; FieldType Get(string, ForgeTypeId unitTypeId)
- void Set(Field, FieldType, DisplayUnitType) &rarr; void Set(Field, FieldType, ForgeTypeId unitTypeId)
- void Set(string, FieldType, DisplayUnitType) &rarr; void Set(string, FieldType, ForgeTypeId unitTypeId)

Autodesk.Revit.DB.FamilyParameter:

- Deprecated &rarr; Replacement
- property DisplayUnitType DisplayUnitType (get) &rarr; ForgeTypeId GetUnitTypeId()

Autodesk.Revit.DB.Parameter:

- Deprecated &rarr; Replacement
- property DisplayUnitType DisplayUnitType (get) &rarr; ForgeTypeId GetUnitTypeId()

Autodesk.Revit.DB.Definition:

- Deprecated &rarr; Replacement
- property UnitType UnitType (get) &rarr; ForgeTypeId GetSpecTypeId()

Autodesk.Revit.DB.Visual.AssetPropertyDistance:

- Deprecated &rarr; Replacement
- property DisplayUnitType DisplayUnitType (get) &rarr; ForgeTypeId GetUnitTypeId()

Autodesk.Revit.DB.Units:

- Deprecated &rarr; Replacement
- FormatOptions GetFormatOptions(UnitType) &rarr; FormatOptions GetFormatOptions(ForgeTypeId specTypeId)
- void SetFormatOptions(UnitType, FormatOptions) &rarr; void SetFormatOptions(ForgeTypeId specTypeId, FormatOptions)
- static bool IsModifiableUnitType(UnitType) &rarr; static bool IsModifiableSpec(ForgeTypeId specTypeId)
- static List<UnitType> GetModifiableUnitTypes() &rarr; static List<ForgeTypeId> GetModifiableSpecs()

Autodesk.Revit.DB.DimensionType:

- Deprecated &rarr; Replacement
- property UnitType UnitType (get) &rarr; ForgeTypeId GetSpecTypeId()

Autodesk.Revit.DB.ExtensibleStorage.Field:

- Deprecated &rarr; Replacement
- bool CompatibleDisplayUnitType(DisplayUnitType) &rarr; bool CompatibleUnit(ForgeTypeId unitTypeId)
- property UnitType UnitType (get) &rarr; ForgeTypeId GetSpecTypeId()

Autodesk.Revit.DB.ExtensibleStorage.FieldBuilder:

- Deprecated &rarr; Replacement
- FieldBuilder SetUnitType(UnitType) &rarr; FieldBuilder SetSpec(ForgeTypeId specTypeId)

Autodesk.Revit.DB.FamilySizeTableColumn:

- Deprecated &rarr; Replacement
- property DisplayUnitType DisplayUnitType (get) &rarr; ForgeTypeId GetUnitTypeId()
- property UnitType UnitType (get) &rarr; ForgeTypeId GetSpecTypeId()

Autodesk.Revit.DB.FormatOptions:

- Deprecated &rarr; Replacement
- FormatOptions(DisplayUnitType) &rarr; FormatOptions(ForgeTypeId unitTypeId)
- FormatOptions(DisplayUnitType, UnitSymbolType) &rarr; FormatOptions(ForgeTypeId unitTypeId, ForgeTypeId symbolTypeId)
- FormatOptions(DisplayUnitType, double) &rarr; This constructor has not been replaced. Please use property assignment to set the accuracy.
- FormatOptions(DisplayUnitType, UnitSymbolType, double) &rarr; This constructor has not been replaced. Please use property assignment to set the accuracy.
- property DisplayUnitType DisplayUnits (get/set) &rarr; ForgeTypeId GetUnitTypeId() and void SetUnitTypeId(ForgeTypeId unitTypeId)
- property UnitSymbolType UnitSymbol (get/set) &rarr; ForgeTypeId GetSymbolTypeId() and void SetSymbolTypeId(ForgeTypeId symbolTypeId)
- static bool CanHaveUnitSymbol(DisplayUnitType) &rarr; static bool CanHaveSymbol(ForgeTypeId unitTypeId)
- bool CanHaveUnitSymbol() &rarr; bool CanHaveSymbol()
- static bool IsValidUnitSymbol(DisplayUnitType, UnitSymbolType) &rarr; static bool IsValidSymbol(ForgeTypeId unitTypeId, ForgeTypeId symbolTypeId)
- bool IsValidUnitSymbol(UnitSymbolType) &rarr; bool IsValidSymbol(ForgeTypeId symbolTypeId)
- static List<UnitSymbolType> GetValidUnitSymbols(DisplayUnitType) &rarr; static List<ForgeTypeId> GetValidSymbols(ForgeTypeId unitTypeId)
- List<UnitSymbolType> GetValidUnitSymbols() &rarr; List<ForgeTypeId> GetValidSymbols()
- static bool IsValidAccuracy(DisplayUnitType, double) &rarr; static bool IsValidAccuracy(ForgeTypeId unitTypeId, double accuracy)
- static bool CanSuppressTrailingZeros(DisplayUnitType) &rarr; static bool CanSuppressTrailingZeros(ForgeTypeId unitTypeId)
- static bool CanSuppressLeadingZeros(DisplayUnitType) &rarr; static bool CanSuppressLeadingZeros(ForgeTypeId unitTypeId)
- static bool CanSuppressSpaces(DisplayUnitType) &rarr; static bool CanSuppressSpaces(ForgeTypeId unitTypeId)
- static bool CanUsePlusPrefix(DisplayUnitType) &rarr; static bool CanUsePlusPrefix(ForgeTypeId unitTypeId)
- bool IsValidForUnitType(UnitType) &rarr; bool IsValidForSpec(ForgeTypeId specTypeId)

Autodesk.Revit.DB.LabelUtils:

- Deprecated &rarr; Replacement
- static string GetLabelFor(DisplayUnitType) &rarr; static string GetLabelForUnit(ForgeTypeId unitTypeId)
- static string GetLabelFor(UnitSymbolType) &rarr; static string GetLabelForSymbol(ForgeTypeId symbolTypeId)
- static string GetLabelFor(UnitType) &rarr; static string GetLabelForSpec(ForgeTypeId specTypeId)

Autodesk.Revit.DB.Structure.ReinforcementRoundingManager:

- Deprecated &rarr; Replacement
- property DisplayUnitType LengthDisplayUnit (get) &rarr; ForgeTypeId GetLengthUnitTypeId()

Autodesk.Revit.DB.ScheduleField:

- Deprecated &rarr; Replacement
- property UnitType UnitType (get) &rarr; ForgeTypeId GetSpecTypeId()

Autodesk.Revit.DB.TableSectionData:

- Deprecated &rarr; Replacement
- UnitType GetCellUnitType(int, int) &rarr; ForgeTypeId GetCellSpec(int, int)

Autodesk.Revit.DB.UnitFormatUtils:

- Deprecated &rarr; Replacement
- static string Format(Units, UnitType, double, bool, bool, FormatValueOptions) and static string Format(Units, UnitType, double, bool, FormatValueOptions) &rarr; static string Format(Units, ForgeTypeId specTypeId, double, bool, FormatValueOptions) &ndash; Note: The "maxAccuracy" option has not been replaced. Please specify the desired precision explicitly.
- static string Format(Units, UnitType, double, bool, bool) and static string Format(Units, UnitType, double, bool) &rarr; static string Format(Units, ForgeTypeId specTypeId, double, bool) &ndash; Note: The "maxAccuracy" option has not been replaced. Please specify the desired precision explicitly.
- static bool TryParse(Units, UnitType, string, ValueParsingOptions, double) &rarr; static bool TryParse(Units, ForgeTypeId specTypeId, string, ValueParsingOptions, double)
- static bool TryParse(Units, UnitType, string, ValueParsingOptions, double, string) &rarr; static bool TryParse(Units, ForgeTypeId specTypeId, string, ValueParsingOptions, double, string)
- static bool TryParse(Units, UnitType, string, double) &rarr; static bool TryParse(Units, ForgeTypeId specTypeId, string, double)
- static bool TryParse(Units, UnitType, string, double, string) &rarr; static bool TryParse(Units, ForgeTypeId specTypeId, string, double, string)

<a name="4.1.4"></a><h2 class="new">1.4. Structural Connections API changes</h2>

- Deprecated member &rarr; Replacement &ndash; Notes
- StructuralConnectionHandler.Create(Document, IList&lt;ElementId&gt;) &rarr; StructuralConnectionHandler.CreateGenericConnection() &ndash; The new method provides an easier and friendlier way to create a generic connection.

<a name="4.1.5"></a><h2 class="new">1.5. Electrical API changes</h2>

- Deprecated member &rarr; Replacement &ndash; Notes
- MEPModel.ElectricalSystems &rarr; MEPModel.GetElectricalSystems() &ndash; The new method returns an ISet&lt;&gt; containing the systems.
- MEPModel.AssignedElectricalSystems &rarr; MEPModel.GetAssignedElectricalSystems() &ndash; The new method returns an ISet&lt;&gt; containing the systems.
- ElectricalSystemSet &rarr; N/A &ndash; new methods will use .NET collections 
- ElectricalSystemSetIterator &rarr; N/A &ndash; new methods will use .NET collections 
- PanelScheduleData.IsThirdPhaseHidden &rarr; PanelScheduleData.IsUnusedPhaseHidden

<a name="4.1.6"></a><h2 class="new">1.6. Cloud Model API changes</h2>

- Deprecated member &rarr; Replacement &ndash; Notes
- ModelPathUtils.ConvertCloudGUIDsToCloudPath (Guid, Guid) &rarr; ModelPathUtils.ConvertCloudGUIDsToCloudPath (string region, Guid, Guid) &ndash; The new method provides an extra argument to indicate the region of the model to open.
- Document.SaveAsCloudModel (string, string) &rarr; Document.SaveAsCloudModel (Guid accountId, Guid projectId, string, string) &ndash; The new method provides two extra arguments to make identifying the cloud location more efficient and reliable.

<a name="4.1.7"></a><h2 class="new">1.7. Raytrace view mode removed</h2>

The Raytrace view mode is no longer available.

The following two enum values have been removed (with no replacement):

- DisplayStyle.Raytrace
- TemporaryViewMode.Raytrace

<a name="4.1.8"></a><h2 class="new">1.8. Schedule API change</h2>

The method

- ViewSchedule.ExportSchedule()

now exports a text filed formatted in UTF8 (it was previously UNICODE) for better scalability and a more modern text format.

<a name="4.1.9"></a><h2 class="new">1.9. Slanted Walls</h2>

Standard walls can now be slanted.
There is no special API for this &ndash; use the standard parameter API to access the properties that control the slanted.
API code should no longer assume that standard walls (or their inserts) are vertical.

Three new parameters have been added:

- BuiltInParameter.WALL_CROSS_SECTION &ndash; An integer that controls whether the wall is vertical (0) or slanted (1).
- BuiltInParameter.WALL_SINGLE_SLANT_ANGLE_FROM_VERTICAL &ndash; A double that controls the angle of the slant relative to vertical, in degrees. The sign of the angle is positive in the direction to the right of the direction of the path curve of the wall, independent of how the wall is flipped.
- BuiltInParameter.INSERT_ORIENTATION &ndash; An integer that controls whether an insert in a wall is vertical (0) or follows the slant of the wall (1).

<a name="4.1.10"></a><h2 class="new">1.10. Path of Travel API change</h2>

The enumerated type:

- Autodesk.Revit.DB.Analysis.PathOfTravelCalculationRequestType

is not used in public API members and thus has been deprecated (with no replacement).

<a name="4.1.11"></a><h2 class="new">1.11. Geometry API changes</h2>

The following methods have been deprecated and replaced:

- Deprecated member &rarr; Replacement
- NurbSpline.isClosed() &rarr; Curve.IsClosed()
- ExportUtils.GetNurbsSurfaceDataForFace() &rarr; ExportUtils.GetNurbsSurfaceDataForSurface()

<a name="4.1.12"></a><h2 class="new">1.12. Extensible Storage API change</h2>

The following method has been deprecated and replaced:

- Deprecated member &rarr; Replacement
- ESSchema.EraseSchemaAndAllEntities() &rarr; Document.EraseSchemaAndAllEntities()

<a name="4.1.13"></a><h2 class="new">1.13. BuiltInParameter names corrected</h2>

A spelling mistake in two BuiltInParameter members has been corrected:

- Replaced member &rarr; Replacement
- RBS_ENERGY_ANALYSIS_BUILDING_ENVELOPE_ANALYTICAL_SURFACE_INDENTIFICATION_RESOLUTION &rarr; RBS_ENERGY_ANALYSIS_BUILDING_ENVELOPE_ANALYTICAL_SURFACE_IDENTIFICATION_RESOLUTION
- RBS_ENERGY_ANALYSIS_BUILDING_ENVELOPE_ANALYTICAL_SPACE_INDENTIFICATION_RESOLUTION &rarr; RBS_ENERGY_ANALYSIS_BUILDING_ENVELOPE_ANALYTICAL_SPACE_IDENTIFICATION_RESOLUTION

<a name="4.1.14"></a><h2 class="new">1.14. SpaceType names corrected</h2>

A spelling mistake in two SpaceType members has been corrected:

- Replaced member &rarr; Replacement
- kComfinementCellsPenitentiary &rarr; kConfinementCellsPenitentiary
- kComfinementCellsCourtHouse &rarr; kConfinementCellsCourtHouse

<a name="4.1.15"></a><h2 class="new">1.15. Image API changes</h2>

Several members have been deprecated and replaced with new methods that use the new ImageTypeSource enumeration. 

- Replaced member &rarr; Replacement
- ImageType.IsViewImage and ImageType.IsLoadedFromFile() &rarr; ImageType.Source
- ImageTypeOptions(), ImageTypeOptions(string) and ImageTypeOptions(string, bool) &rarr; ImageTypeOptions(string, bool, ImageTypeSource) or ImageTypeOptions(ExternalResourceReference, ImageTypeSource)

<a name="4.1.16"></a><h2 class="new">1.16. Obsolete API removal</h2>

The following API members and classes which had previously been marked Obsolete have been removed in this release. Consult the API documentation from prior releases for information on the replacements to use:

<a name="4.1.16.1.1"></a><h4 class="new">1.16.1.1. Classes</h2>

- Autodesk.Revit.DB.ImageImportOptions

<a name="4.1.16.1.2"></a><h4 class="new">1.16.1.2. Methods</h2>

- Document.Import(String, ImageImportOptions, View, out Element)
- ExternalResourceBrowserData.GetSubFolders()
- ImageView.Create(Document, String)
- Autodesk.Revit.Creation.Application.NewImageImportOptions()
- StructuralConnectionHandler.GetSubPartIds()
- FabricationConfiguration.GetMaterialThickness()

<p></p>

<center>
<div style="border-style:solid; border-width:2px 0px 2px 0px">
<a name="4.2"></a><h1 class="new" style="font-weight: bold">API Additions</h1>
</div>
</center>

<a name="4.2.1"></a><h2 class="new">2.1. Systems Analysis API additions</h2>

<a name="4.2.1.1"></a><h3 class="new">2.1.1. Mechanical Analytical Systems</h2>

The new class:

- Autodesk.Revit.DB.Mechanical.MEPAnalyticalSystem

represents an HVAC analytical system element where the air or water is circulated to satisfy building energy requirements.
Its AnalyticalSystemDomain property indicates whether the element represents a water loop or air system.

The new class:

- Autodesk.Revit.DB.Mechanical.WaterLoopData

contains the data for a water loop system. It can be obtained from the MEPAnalyticalSystem.GetWaterLoopData() method. It offers the following properties:

- WaterLoopData.WaterLoopType
- WaterLoopData.ChillerType
- WaterLoopData.CondenserWaterLoopId

The new class:

- Autodesk.Revit.DB.Mechanical.AirSystemData

contains the data for an air system.
It can be obtained from the MEPAnalyticalSystem.GetAirSystemData() method.
It offers the following properties:

- AirSystemData.HeatExchangerType
- AirSystemData.PreheatCoilType
- AirSystemData.HeatingCoilType
- AirSystemData.AirSystemCoolingCoilType
- AirSystemData.AirFanType

<a name="4.2.1.2"></a><h3 class="new">2.1.2. Zone equipment</h2>

The new class:

- Autodesk.Revit.DB.Mechanical.ZoneEquipment

represents a zone equipment element used for Mechanical Systems Analysis.
Zone equipment is an early-stage equipment placeholder that provides heating or cooling to part of the air system or water loop.
One zone equipment element may be mapped to multiple pieces of physical equipment depending on the zoning behavior type.

Analytical spaces may be associated to one or more zone equipment elements. The method:

- ZoneEquipment.MoveSpaceToEquipment() 

moves a set of spaces from the original zone equipment to the targeted zone equipment. Either zone equipment id may be InvalidElementId. If the original is InvalidElementId, the association is copied to the target zone equipment. If the target is InvalidElementId, the original association is removed. The method:

- ZoneEquipment.GetAssociatedZoneEquipment() 

returns the set of zone equipment that is associated with the specified analytical space or spaces. 

The new class

- Autodesk.Revit.DB.Mechanical.ZoneEquipmentData

represents the data associated with a zone equipment. It can be obtained from the ZoneEquipment.GetZoneEquipmentData() method. It offers the following properties:

- ZoneEquipmentData.EquipmentType
- ZoneEquipmentData.EquipmentBehavior
- ZoneEquipmentData.HotWaterLoopId
- ZoneEquipmentData.ChilledWaterLoopId
- ZoneEquipmentData.AirSystemId

<a name="4.2.1.3"></a><h3 class="new">2.1.3. System-Zones</h2>

A system-zone in Revit is used to specify what parts of a building are served by specific equipment, air systems and water loops, without having to physically model them. In the Revit API, a system-zone is represented as a GenericZone element with a domain data of type SystemZoneData.

The new class

- Autodesk.Revit.DB.GenericZone

provides for a method of selecting elements that somehow come in contact with the zone object. A zone is a non-hierarchical structure of geometric information, area or volume definitions for the purpose of analysis. A generic zone will contain specific domain requirements provided at creation of the element. Currently, all GenericZones will represent system-zone elements used for MEP design. Some relevant new members of GenericZones include:

- GenericZone.Create(Document doc, String name, GenericZoneDomainData domainData, ElementId levelId, IList&lt;CurveLoop&gt; curves) &ndash; supports creation of a zone using the specified domain data, level and curves to represent the intersection/outline of the related spaces.
- GenericZone.GetBoundaries() &ndash; Gets the boundaries for the given GenericZone.
- GenericZone.GetDomainData() &ndash; Returns the domain data for the given GenericZone.

For system-zone elements, the domain data will be an instance of the new class:

- Autodesk.Revit.DB.SystemZoneData

This data includes a reference to the zone equipment for the spaces in this system-zone:

- SystemZoneData.ZoneEquipmentId

<a name="4.2.1.4"></a><h3 class="new">2.1.4. Systems Analysis and Analysis Reports</h2>

The new class

- Autodesk.Revit.DB.Analysis.ViewSystemsAnalysisReport

represents a view instance of the systems analysis report. In a typical API workflow, to run a systems analysis against a Revit project, create (via ViewSystemsAnalysisReport.Create()) a new view instance and request (via ViewSystemsAnalysisReport.RequestSystemsAnalysis()) the systems analysis from that view. The analysis will run in the background, and when the analysis is completed, the related views are automatically updated. The method RequestSystemsAnalysis.IsAnalysisCompleted indicates if the background systems analysis has completed or not.

It is possible for a project to contain multiple systems analysis reports. The method:

- ViewSystemsAnalysisReport.GetLatestSystemsAnalysisReport()

returns the latest report of systems analysis. The peak heating/cooling loads of all EnergyAnalysisSpace elements should be consistent with this latest report.

The new class

- Autodesk.Revit.DB.Analysis.SystemsAnalysisOptions

contains some properties (e.g., WeatherFile, WorkflowFile, and OutputFolder) that affect the systems analysis. It is okay to leave some parameters empty. In those cases, the analysis will take the default value from the ViewSystemsAnalsisReport element. The weather file affects the results of energy simulation. More weather files are available at http://energyplus.net/weather .

<a name="4.2.1.5"></a><h3 class="new">2.1.5. Export to gbXML</h2>

The new property:

- GBXMLExportOptions.ExportAnalyticalSystems 

should be set to true to export the analytical system related items when exporting to gbXML.

<a name="4.2.1.6"></a><h3 class="new">2.1.6. Application settings</h2>

The new methods:

- Application.GetSystemsAnalysisWorkflowNames()
- Application.GetSystemsAnalysisWorkflows() 
- Application.SetSystemsAnalysisWorkflows() 

allow you to read and specify the name and path information names for systems analysis workflows.

<a name="4.2.2"></a><h2 class="new">2.2. Electrical API additions</h2>

<a name="4.2.2.1"></a><h3 class="new">2.2.1. Circuit naming</h2>

The new class:

- Autodesk.Revit.DB.Electrical.CircuitNamingScheme

represents a scheme used for electrical circuit naming. The most significant new methods on this class include:

- CircuitNamingScheme.Create()
- CircuitNamingScheme.GetCombinedParameters() 
- CircuitNamingScheme.SetCombinedParameters()

allowing schemes to be created, and allowing access to the list of combined parameters associated with the scheme.

The new class:

- Autodesk.Revit.DB.Electrical.CircuitNamingSchemeSettings

represents the circuit naming scheme settings object in a project document. The most significant new members on this class include:

- CircuitNamingSchemeSettings.GetCircuitNamingSchemeSettings() 
- CircuitNamingSchemeSettings.CircuitNamingSchemeId

<a name="4.2.2.2"></a><h3 class="new">2.2.2. Access to circuit naming, switchboards and other properties</h2>

Several new properties and methods have been added to support access to circuit naming information on a variety of elements:

- ElectricalSetting.GetCircuitNamingSchemeSettings() &ndash; Gets the circuit naming scheme settings of the project.
- ElectricalSystem.SlotIndex &ndash; The Slots where the Electrical System is located in its panel.
- ElectricalSystem.CircuitNamingIndex &ndash; The Circuit Naming Index where the Electrical System is located in its panel.
- ElectricalSystem.PhaseLabel &ndash; The circuit phase label used in the Electrical System.
- ElectricalSystem.Ways &ndash; The circuit ways used in the Electrical System.
- ElectricalSystem.LoadClassificationAbbreviations &ndash; The LoadClassification Abbreviations used in the Electrical System.
- ElectricalLoadClassification.Abbreviation &ndash; The abbreviation of the load classification name.
- ElectricalEquipment.CircuitNamingSchemeId &ndash; The CircuitNamingSchemeId used in the Electrical Equipment.
- ElectricalEquipment.IsValidDistributionSystem() &ndash; Verifies that the Distribution System can be assigned to the Electrical Equipment.
- ElectricalEquipment.IsValidCircuitNamingSchemeId() &ndash; Verifies that the circuit naming scheme id can be used with Electrical Equipment.
- ElectricalEquipment.GetCircuitNamingSchemeType() &ndash; Gets enumerated type of the circuit naming scheme used with Electrical Equipment.
- ElectricalEquipment.SetCircuitNamingSchemeType() &ndash; Sets the circuit naming scheme for Electrical Equipment.
- PanelScheduleView.RenumberIndexes() &ndash; Renumbers the Circuit Naming Index for the circuits in the panel.
- ElectricalEquipment.MaxNumberOfCircuits &ndash; The maximum number of circuits for switchboard.
- ElectricalEquipment.IsSwitchboard() &ndash; Verifies that the electrical equipment is a switchboard.
- PanelScheduleView.SwitchPhases() &ndash; Switches the circuit phases at the slot.
- ElectricalSystem.Frame &ndash; Retrieves the Frame value of the Electrical System.
- PanelScheduleData.IsUnusedPhaseHidden &ndash; True if the user wishes to hide the unused phase column of a single phase panel, false otherwise.

<a name="4.2.3"></a><h2 class="new">2.3. Element and ElementFilter additions</h2>

<a name="4.2.3.1"></a><h3 class="new">2.3.1. Element History</h2>

The new property:

- Element.VersionGuid

gets an element version Guid that can be used to see whether this element has changed compared to the previous saved or synchronized version of the document.

<a name="4.2.3.2"></a><h3 class="new">2.3.2. Element Filters</h2>

Two new element filter classes have been added for use in FilteredElementCollector and other tools leveraging ElementFilter classes.

The new class:

- Autodesk.Revit.DB.ElementIdSetFilter

is a quick filter wrapping a set of element ids.

The new class:

- Autodesk.Revit.DB.VisibleInViewFilter

is a quick filter that passes elements that are most likely visible in the given view.

<a name="4.2.4"></a><h2 class="new">2.4. Document API additions</h2>

Two new document events provide additional flexibility to react when a document is reloaded:

- Application.DocumentReloadingLatest
- Application.DocumentReloadedLatest

Subscribers to these events will be provided an argument object containing the path to the central model. Document changes are permitting during both events.

<a name="4.2.5"></a><h2 class="new">2.5. View API additions</h2>

<a name="4.2.5.1"></a><h3 class="new">2.5.1. Split sections</h2>

The new methods:

- DBViewSection.IsSplitSection()
- ViewCropRegionShapeManager.GetSplitRegionOffset()

identify if a section view is split, and return the offset for the specified split crop region.

<a name="4.2.5.2"></a><h3 class="new">2.5.2. Temporary View Modes</h2>

The Revit API now allows customization to create "custom temporary view modes" applied to a view as a temporary view property.

For this release, the "Reveal Obstacles for Path of Travel" temporary mode is implemented this way. It uses the Analysis Visualization Framework (AVF) to display additional graphics on top of the view contents.

The new properties:

- TemporaryViewModes.CustomTitle
- TemporaryViewModes.CustomColor
- TemporaryViewModes.ResetCustomization()
- TemporaryViewModes.IsCustomized()

provide access to read and modify a custom temporary view mode. CustomTitle should be set to cause the view to display the customized frame. The application is responsible to adjust the appearance of elements in the view related to the mode.

<a name="4.2.5.3"></a><h3 class="new">2.5.3. Filters</h2>

The new methods:

- View.GetIsFilterEnabled()
- View.SetIsFilterEnabled() 

identify or set if the filter is enabled in this view. 

The new method:

- View.GetOrderedFilters() 

gets the filters applied to the view in the order they are applied.

<a name="4.2.6"></a><h2 class="new">2.6. Schedule API additions</h2>

<a name="4.2.6.1"></a><h3 class="new">2.6.1. Striped rows</h2>

The new properties:

- ViewSchedule.HasStripedRows
- ViewSchedule.UseStripedRowsOnSheets

provides access to read or set if a given schedule is using a striped row display, and whether that display will be used on a sheet that displays this schedule.

The new methods:

- ViewSchedule.GetStripedRowsColor() 
- ViewSchedule.SetStripedRowsColor() 

get and set the color applied to the indicated part of the pattern for a schedule with striped rows.

<a name="4.2.6.2"></a><h3 class="new">2.6.2. Frozen header</h2>

The new property:

- ViewSchedule.IsHeaderFrozen 

provides access to read or set if the header is frozen on a given schedule.

<a name="4.2.7"></a><h2 class="new">2.7. Path of Travel API</h2>

<a name="4.2.7.1"></a><h3 class="new">2.7.1. Reveal Obstacles mode for Path of Travel</h2>

The Reveal Obstacles view mode highlights elements in the plan view when those elements will act as obstacles for the current Path of Travel calculation settings. The new methods:

- PathOfTravel.IsInRevealObstaclesMode()
- PathOfTravel.SetRevealObstaclesMode()

provide access to read or set if a view is displaying this mode.

<a name="4.2.7.2"></a><h3 class="new">2.7.2. Path finding analysis for Path of Travel</h2>

New static methods added:

- List&lt;XYZ&gt; PathOfTravel.FindStartsOfLongestPathsFromRooms(View view, List&lt;XYZ&gt; destinationPoints)

For a floor plan view, calculates paths from points inside rooms to the closest of the destinations.

Returns the start points of the longest path(s). If multiple paths have the same longest length, returns multiple start points.

The entire plan is divided in small tiles, and the distance to the closest destination point is calculated for each tile center point. Only tile center points that are located in rooms in the view are taken into account.

- List&lt;XYZ&gt; PathOfTravel.FindEndsOfShortestPaths(View view, List&lt;XYZ&gt; destinationPoints, List&lt;XYZ&gt; startPoints)

For a floor plan view, calculates the paths from each start point to its closest destination and return the path end points.

The calculation is done in a floor plan with one or more destinationPoints and one or more startPoints. 

The shortest path is calculated from each start point to its corresponding closest destination.

- List&lt;List&lt;XYZ&gt;&gt; PathOfTravel.FindShortestPaths(View view, List&lt;XYZ&gt; destinationPoints, List&lt;XYZ&gt; startPoints)

For a floor plan view, calculates paths from each start point to its closest destinations.

Returns the path, represented by an array of XYZ points.

The calculation is done in a floor plan with one or more destinationPoints and one or more startPoints. 

The shortest path is calculated from each start point to its closest destination point.

<a name="4.2.7.3"></a><h3 class="new">2.7.3. Waypoints</h2>

The new methods:

- PathOfTravel.GetWaypoints()
- PathOfTravel.InsertWaypoint()
- PathOfTravel.SetWaypoint()
- PathOfTravel.RemoveWaypoint()

provide access to read and modify the waypoints associated to a particular PathOfTravel element. Waypoints force the path of travel calculation to ensure that the path includes each of the specified points, in the order specified, between the start and end points.

<a name="4.2.8"></a><h2 class="new">2.8. Export API additions</h2>

<a name="4.2.8.1"></a><h3 class="new">2.8.1. CustomExporter events</h2>

Subscribe to the events:

- Autodesk.Revit.ApplicationServices.Application.ViewsExportingByContext
- Autodesk.Revit.ApplicationServices.Application.ViewsExportedByContext

to be notified when Revit is just about to export, or has just exported, one or more views of the document via an export context by CustomExporter. 

Handlers of this event are permitted to make modifications to any document (including the active document), except for documents that are currently in read-only mode.

The new class:

- Autodesk.Revit.DB.Events.ViewsExportingByContextEventArgs

provides information when Revit is just about to export one or more views of the document via an export context by CustomExporter.

The class has the following method:

- ViewsExportingByContextEventArgs.GetViewIds() &ndash; Gets the ids of views about to be exported by CustomExporter.

The new class:

- Autodesk.Revit.DB.Events.ViewsExportedByContextEventArgs

provides information when Revit has just exported one or more views of the document via an export context by CustomExporter.

The class has the following method:

- ViewsExportingByContextEventArgs.GetViewIds() &ndash; Gets the ids of views that have been exported by CustomExporter.

<a name="4.2.9"></a><h2 class="new">2.9. Options API additions</h2>

<a name="4.2.9.1"></a><h3 class="new">2.9.1. Color options </h2>

The new class:

- Autodesk.Revit.DB.ColorOptions

provides access to color settings which affect the colors applied to specific views. 

The ColorOptions for the current session of Revit can be accessed via:

- static ColorOptions.GetColorOptions()

It has the following properties:

- BackgroundColor &ndash; The background color applied to views.
- SelectionColor &ndash; The color used to highlight selected elements. 
- SelectionSemitransparent &ndash; Indicates whether or not selections will be shown in a semi-transparent manner. 
- PreselectionColor &ndash; The color used to highlight candidates for selection before they are selected. 
- AlertColor &ndash; The color used to highlight elements when a special alert is required. 
- CalculatingColor &ndash; The color used to render elements when some aspect of their properties is currently being recalculated.
- EditingColor &ndash; The color used to render elements when editing.

<a name="4.2.10"></a><h2 class="new">2.10. Geometry API additions</h2>

<a name="4.2.10.1"></a><h3 class="new">2.10.1. Surfaces</h2>

The new class:

- Autodesk.Revit.DB.OffsetSurface

encapsulates the mathematical representation of a surface offset at a normal distance from an originating surface.

The new method:

- Surface.GetBoundingBoxUV() 

gets the UV bounding box of the surface.

The new class:

- Autodesk.Revit.DB.CurveUV

represents the notion of a curve in the 2D parameter space of a surface in 3D space. This class includes a utility method:

- CurveUV.As3DCurveInXYPlane()

that returns a 3D curve lying in the XY plane in XYZ coordinates, representing the 2D curve with its UV coordinates identified with XY coordinates.

<a name="4.2.10.2"></a><h3 class="new">2.10.2. Edges</h2>

The new methods:

- Edge.IsFlippedOnFace(int index) 
- Edge.IsFlippedOnFace(Face face) 

determine if the edge's topological direction on the Face is opposite to its parametric direction.

The new class:

- EdgeEndPoint &ndash; Represents the start or the end point of an Edge.

it can be used in the new method:

- SolidUtils.FindAllEdgeEndPointsAtVertex()

which will find all EdgeEndPoints at a vertex identified by the input EdgeEndPoint.

The new overloaded methods:

- Edge.GetCurveUV() 

Calculate and (optionally) transform a 2D curve that represents the edge in the UV-parameter plane of one of the edge's faces.

<a name="4.2.10.3"></a><h3 class="new">2.10.3. Meshes</h2>

The new members:

- Mesh.GetNormal()
- Mesh.GetNormals()
- Mesh.DistributionOfNormals
- Mesh.NumberOfNormals

provide information about the normal vectors contained in a Mesh.

<a name="4.2.10.4"></a><h3 class="new">2.10.4. Geometry utilities</h2>

The new property:

- GeometryObject.Id

returns a unique integer identifying the GeometryObject in its associated GeometryElement.

The new class:

- Autodesk.Revit.DB.MathComparisonUtils

contains a set of mathematical utilities to compare doubles, using the Revit predefined internal tolerance.

The new classes:

- Autodesk.Revit.DB.Transform1D
- Autodesk.Revit.DB.Transform2D

representing an affine transform of 1D or 2D Euclidean space.

The new property:

- BoundingBoxUV.IsSet

indicates whether the BoundingBoxUV is set or not.

<a name="4.2.11"></a><h2 class="new">2.11. Image API additions</h2>

<a name="4.2.11.1"></a><h3 class="new">2.11.1. Image properties</h2>

The new properties:

- ImageType.Resolution
- ImageType.WidthInPixels
- ImageType.HeightInPixels
- ImageType.Width
- ImageType.Height

provide read access to some of the image size and resolution properties.

<a name="4.2.11.2"></a><h3 class="new">2.11.2. Converting images between links and imports</h2>

The new property:

- ImageTypeOptions.SourceType

along with the new enumerated value

- ImageTypeSource

will allow you to create or convert an ImageType to a link or import.

Two new constructors take an ImageTypeSource as an argument:

- ImageTypeOptions(String, Boolean, ImageTypeSource)
- ImageTypeOptions(ExternalReference, ImageTypeSource)

Several new methods and properties have also been added to ImageType:

- ImageType.Source &ndash; Indicates how the image is created (as a link, import, or internally-generated image)
- ImageType.Status &ndash; Indicates whether the image is loaded or unloaded (if applicable)
- ImageType.Unload() &ndash; Unloads a linked image

The new enumeration:

- ImageTypeStatus

contains possible values for the load status of an ImageType.

<a name="4.2.12"></a><h2 class="new">2.12. Cloud Model API additions</h2>

<a name="4.2.12.1"></a><h3 class="new">2.12.1. Regions</h2>

The new property:

- ModelPath.Region

returns the region of the BIM 360 account and project which contains this model.

The new static properties:

- ModelPathUtils.CloudRegionUS
- ModelPathUtils.CloudRegionEMEA

return the region names of different BIM 360 cloud services. They can be used as the first argument of the ModelPathUtils.ConvertCloudGUIDsToCloudPath() method.

<a name="4.2.12.2"></a><h3 class="new">2.12.2. Opening Cloud Models</h2>

The new enumeration value:

- OpenConflictScenario.VersionArchived

indicates that last central version merged into the local model to open has been archived in the central model.

The new enumeration value:

- OpenConflictResult.DetachFromCentral

provides the option to detach the local model from its central model, with worksets preserved.

<a name="4.2.13"></a><h2 class="new">2.13. Structural Connection API addition</h2>

<a name="4.2.13.1"></a><h3 class="new">2.13.1. Connections requiring additional points</h2>

The new class:

- Autodesk.Revit.DB.Structure.ConnectionInputPoint

contains the 3D location and unique id for one structural connection input point.

The new class:

- Autodesk.Revit.DB.Structure.ConnectionInputPointInfo

contains information about connection input points requirements, such as number of required points, a user visible description for each point, and potential location restrictions.

The new method:

- Autodesk.Revit.DB.Structure.StructuralConnectionHandler.Create(Document, IList&lt;ElementId&gt;, ElementId, IList&lt;XYZ&gt;)

provides a way to create connections that require additional input points.

The following new methods use input points:

- static Autodesk.Revit.DB.Structure.StructuralConnectionHandlerType.Create(Document, string, Guid, string, ElementId, IList&lt;ConnectionInputPointInfo&gt;)
- Autodesk.Revit.DB.Structure.StructuralConnectionHandler.GetInputPoints()
- Autodesk.Revit.DB.Structure.StructuralConnectionHandler.GetInputPoint()

<a name="4.2.14"></a><h2 class="new">2.14. Reinforcement API additions</h2>

<a name="4.2.14.1"></a><h3 class="new">2.14.1. Rebar constraints</h2>

Several new RebarConstraint methods allow control over distances and spacing:

- RebarConstraint.GetDistanceToTargetRebar()
- RebarConstraint.SetDistanceToTargetRebar() 
- RebarConstraint.IsBindingHandleWithTarget() 
- RebarConstraint.SetToBindHandleWithTarget() 
- RebarConstraint.IsUsingClearBarSpacing()
- RebarConstraint.SetToUseClearBarSpacing() 
- RebarConstraint.FlipHandleOverTarget() 

Two new methods have been added to RebarConstraintsManager:

- RebarConstraintsManager.GetConstraintCandidatesForHandle(RebarConstrainedHandle, ElementId)
- RebarConstraintsManager.GetConstraintCandidatesForHandle(RebarConstrainedHandle, Reference) 

These methods return all possible RebarConstraints that could be used for a RebarConstrainedHandle related to the additional input. For free form rebar these will return an empty list.

<a name="4.2.14.2"></a><h3 class="new">2.14.2. Rebar end treatment</h2>

The new method:

- Rebar.SetEndTreatmentTypeId()

sets the id of the EndTreatmentType to be applied to the rebar at the specified end.

<a name="4.2.14.3"></a><h3 class="new">2.14.3. Fabric Sheet visibility</h2>

The new methods:

- FabricSheet.IsSolidInView()
- FabricSheet.SetSolidInView()
- FabricSheet.IsUnobscuredInView()
- FabricSheet.SetUnobscuredInView()

get and set the visibility options for a given fabric sheet instance as applied to a particular 3D view.

<a name="4.2.14.4"></a><h3 class="new">2.14.4. Out of plane hook rotation angles</h2>

Several new static creation methods take into account the out of plane hook rotation angle and the end treatment type id:

- static Rebar.CreateFromCurves() &ndash; Creates a new instance of a shape driven Rebar element within the project, given an array of curves and properties.
- static Rebar.CreateFromCurvesAndShape() &ndash; Creates a new instance of a shape driven Rebar element within the project, given an array of curves, a RebarShape and some properties.
- static Rebar.RebarShapeMatchesCurvesHooksAndEndTreatment() &ndash; Checks if rebarShape matches curves, hooks and end treatment.
- static RebarShape.Create() &ndash; Creates a new instance of a RebarShape, which defines the shape of a Rebar.

The following methods allow getting or setting the out of plan hook rotation angle:

- Rebar.GetHookRotationAngle()
- Rebar.SetHookRotationAngle()
- RebarShape.GetHookRotationAngle()
- RebarShape.SetHookRotationAngle()

These methods all affect the angle at the specified end.

<a name="4.2.14.5"></a><h3 class="new">2.14.5. Hook length overrides</h2>

The following new Rebar methods enable overriding the hook length from the API:

- Rebar.EnableHookLengthOverride()
- Rebar.IsHookLengthOverrideEnabled()
- Rebar.GetOverridableHookParameters() &ndash; Outputs the formula parameter ids defined in the RebarShape family which are associated with hook length and hook tangent length parameters.

<a name="4.2.15"></a><h2 class="new">2.15. Material API addition</h2>

The new property: 

- StructuralAsset.MetalThermallyTreated

indicates whether the asset describes a material that is thermally treated or not, corresponding to the BuiltInParameter member PHY_MATERIAL_PARAM_STRUCTURAL_THERMAL_TREATED.

<a name="4.2.16"></a><h2 class="new">2.16. Analysis Visualization Framework API addition</h2>

The new property:

- SpatialFieldManager.AllowInteractiveSettings

toggles the ability to access the Analysis Visualization Framework (AVF) settings for a particular set of results. This property is true by default. If the property is set to false, all AVF dialogs are unreachable in the UI.

Also, if the property is set to false, deletion of the SpatialFieldManager, its parts or associated AnalysisDisplayLegend element is prohibited.

<a name="4.2.17"></a><h2 class="new">2.17. Shared Coordinates API additions</h2>

<a name="4.2.17.1"></a><h3 class="new">2.17.1. Internal Origin </h2>

The new class:

- Autodesk.Revit.DB.InternalOrigin

represents the origin of Revit's internal coordinate system. Each Revit project contains one InternalOrigin.

It has the following members:

- static InternalOrigin.Get(Document doc) &ndash; Returns the internal origin of the project. There is one InternalOrigin per document.
- InternalOrigin.Position &ndash; Read-only property which returns the XYZ value of the internal coordinates.
- InternalOrigin.SharedPosition &ndash; Read-only property which returns the shared position of the internal origin based on the active ProjectLocation of its Document.

<a name="4.2.17.2"></a><h3 class="new">2.17.2. BasePoint</h2>

Two new methods provide access to the base and survey point:

- static BasePoint.GetProjectBasePoint() 
- static BasePoint.GetSurveyPoint() 

